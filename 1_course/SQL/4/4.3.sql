SELECT A.WARE, CLASS, PRICE
FROM (SELECT WARE, max(PRICE) AS PRICE
FROM PRODUCT
GROUP BY WARE
ORDER BY max(PRICE) DESC) B
JOIN CATEGORY A ON A.WARE = B.WARE
GROUP BY CLASS